# BlindMark Master 使用指南

> 批量盲水印工具 · 支持 .zip / .7z / .var / .rar 压缩包

---

## 目录

1. [软件简介](#软件简介)
2. [安装与启动](#安装与启动)
3. [嵌入水印](#嵌入水印)
   - [选择压缩包](#选择压缩包)
   - [水印来源](#水印来源)
   - [编码方式](#编码方式)
   - [处理类型](#处理类型)
   - [图片水印设置](#图片水印设置)
   - [水印字段配置](#水印字段配置)
   - [输出目录](#输出目录)
   - [开始处理](#开始处理)
4. [提取水印](#提取水印)
5. [输出文件说明](#输出文件说明)
6. [常见问题](#常见问题)

---

## 软件简介

BlindMark Master 是一款桌面端批量盲水印工具，可对压缩包内的文件批量嵌入不可见水印，同时支持从已处理文件中提取水印内容。

**支持的文件类型：**

| 类别 | 格式 |
|------|------|
| 压缩包 | `.zip` `.7z` `.var` `.rar` |
| 数据文件 | `.json` `.vaj` `.vmi` |
| 图片 | `.png`（仅 PNG 支持图片盲水印） |

---

## 安装与启动

**macOS：** 打开 `.dmg` 文件，将 `BlindMark Master.app` 拖入应用程序文件夹，双击启动。

**Windows：** 运行 `BlindMark Master_x64-setup.exe` 或 `.msi` 安装包，安装完成后从开始菜单启动。

> 首次启动 macOS 可能提示"无法验证开发者"，前往 **系统设置 → 隐私与安全性** 点击"仍要打开"即可。

---

## 嵌入水印

切换到顶部 **嵌入** 标签页开始操作。

### 选择压缩包

点击压缩包区域的虚线框，或直接将压缩包文件**拖入软件窗口**。

支持格式：`.zip` `.7z` `.var` `.rar`

### 水印来源

| 模式 | 说明 |
|------|------|
| **固定文本** | 压缩包内所有文件使用同一个水印文本 |
| **Excel 批量** | 选择 `.xlsx` / `.xls` 文件，按行顺序逐个对应文件 |

**Excel 批量模式说明：**
- 使用第一列数据，首行视为表头自动跳过
- 第 2 行对应压缩包内第 1 个文件，第 3 行对应第 2 个文件，以此类推
- 文件排列顺序按路径字母升序排列
- 若文件数多于 Excel 行数，超出部分使用最后一行的水印

### 编码方式

| 方式 | 说明 | 适用场景 |
|------|------|----------|
| **MD5 哈希** | 将文本转为不可逆 MD5 哈希后写入 | 隐藏原始内容，默认推荐 |
| **明文** | 原文直接写入 | 水印内容无需保密 |
| **AES-256-GCM** | 加密后写入，提取时需输入相同密钥 | 高安全性场景 |

> 选择 AES 模式后，需在下方输入框中设置密钥。请妥善保管密钥，提取水印时必须使用相同密钥。

### 处理类型

勾选需要嵌入水印的文件类型：

| 类型 | 说明 |
|------|------|
| **JSON** | 处理压缩包内所有 `.json` 文件 |
| **VAJ** | 处理压缩包内所有 `.vaj` 文件 |
| **VMI** | 处理压缩包内所有 `.vmi` 文件 |
| **图片** | 处理压缩包内 PNG 图片（JPG/JPEG 原样保留） |

至少需要勾选一种类型才能开始处理。

### 图片水印设置

勾选**图片**类型后，会出现以下额外选项：

**高速模式**
- 开启后：图片超过 512px 时仅处理左上角 512×512 区域，速度可提升 4–10 倍
- 关闭后：处理完整图片，水印覆盖范围更广

**图片选择列表**
- 显示压缩包内所有图片文件
- 点击 **全选 PNG** 快速选中所有可处理图片
- 点击 **取消全选** 清空选择
- JPG/JPEG 文件显示为"仅限 PNG"，无法勾选

### 水印字段配置

**水印字段名**
- 自定义嵌入的字段名称，留空则使用默认值 `_watermark`
- 开启混淆后此选项隐藏

**水印混淆**
- 开启后随机命名水印字段，并插入既有字段旁，提高隐蔽性
- 适合对水印存在隐蔽性要求的场景

### 输出目录

- 默认将输出文件保存在**与源文件相同的目录**
- 点击**选择目录**可自定义输出位置
- 点击 `×` 清除自定义路径，恢复为默认

### 开始处理

确认配置无误后，点击 **开始嵌入** 按钮。

- 处理过程中按钮变为不可点击，显示进度状态
- 底部状态栏实时显示当前处理的文件名及耗时
- 处理完成后显示输出文件路径，可点击旁边的**复制**按钮复制路径

---

## 提取水印

切换到顶部 **提取** 标签页。

1. **选择压缩包**：点击或拖入已嵌入水印的压缩包
2. **AES 密钥**（可选）：若嵌入时使用了 AES 加密，需在此输入相同密钥
3. **扫描图片水印**：开启后同时提取 PNG 图片中的盲水印
4. 点击 **开始提取**

**提取结果说明：**

| 结果 | 含义 |
|------|------|
| 字段名 + 水印值 | 成功提取的水印内容 |
| MD5 哈希字符串 | 使用 MD5 模式嵌入时的提取结果（32位十六进制） |
| 图片扫描结果 | 显示每张 PNG 图片检测到的水印哈希 |
| 未找到水印字段 | 压缩包内无水印，或密钥不正确 |

点击各条结果右侧的**复制**按钮可复制水印内容。

---

## 输出文件说明

处理完成后，输出文件保存在以**水印文本**命名的子文件夹内，文件名与原始压缩包保持一致：

```
输出目录/
└── <水印文本>/
    └── 原文件名.zip
```

**固定文本模式示例：**
```
输出目录/
└── 张三/
    └── data.zip
```

**Excel 批量模式示例：**
```
输出目录/
├── 张三/
│   └── data.zip
├── 李四/
│   └── data.zip
└── 王五/
    └── data.zip
```

原始文件**不会被修改**，输出为全新文件。

---

## 常见问题

**Q：图片嵌入水印后视觉上有变化吗？**
A：采用 DWT+DCT 频域算法，正常强度下肉眼不可见。

**Q：为什么 JPG/JPEG 图片无法嵌入水印？**
A：JPEG 使用有损压缩，会破坏频域水印信息，因此仅支持 PNG 格式的图片水印。

**Q：Excel 批量模式下，文件的排列顺序是什么？**
A：按文件在压缩包内的相对路径字母升序排列（A→Z）。建议在 Excel 中按相同顺序排列对应水印文本。

**Q：MD5 模式提取后得到的是哈希值，如何对应原始文本？**
A：MD5 是不可逆的，提取结果为 32 位哈希。验证时需将原始文本重新计算 MD5 后与提取结果比对。

**Q：AES 密钥忘记了怎么办？**
A：无法找回，AES 模式的水印在没有正确密钥的情况下无法提取。

**Q：处理大型压缩包时很慢怎么办？**
A：开启**高速模式**可显著提升图片处理速度。数据文件（JSON/VAJ/VMI）的处理速度取决于文件数量，软件已使用多核并行处理。

**Q：输出的压缩包格式与原来一致吗？**
A：是的，输入什么格式输出同样格式，目录结构也完整保留。

---

*BlindMark Master v0.1.0 · by lulu*
